<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Schema | Orango</title>
    <meta name="description" content="ArangoDB Object Modeler for Node.js, Foxx and Web Browsers">
    <link rel="icon" href="/icons/favicon.ico">
  <link rel="manifest" href="/site.webmanifest">
  <meta name="theme-color" content="#fd6602">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="#fd6602">
  <link rel="apple-touch-icon" href="/icons/apple-touch-icon.png">
  <link rel="mask-icon" href="/icons/safari-pinned-tab.svg" color="#3eaf7c">
  <meta name="msapplication-TileImage" content="/icons/mstile-150x150.png">
  <meta name="msapplication-TileColor" content="#fd6602">
    
    <link rel="preload" href="/assets/css/0.styles.c6f2c4ad.css" as="style"><link rel="preload" href="/assets/js/app.638713ad.js" as="script"><link rel="preload" href="/assets/js/14.64c86a24.js" as="script"><link rel="prefetch" href="/assets/js/12.bdb0900e.js"><link rel="prefetch" href="/assets/js/2.234811cb.js"><link rel="prefetch" href="/assets/js/3.b0961c5f.js"><link rel="prefetch" href="/assets/js/4.b7431d6a.js"><link rel="prefetch" href="/assets/js/5.5d620026.js"><link rel="prefetch" href="/assets/js/6.e99efd1f.js"><link rel="prefetch" href="/assets/js/7.cabad610.js"><link rel="prefetch" href="/assets/js/8.8dd83b6a.js"><link rel="prefetch" href="/assets/js/9.e54f44c5.js"><link rel="prefetch" href="/assets/js/10.278ae628.js"><link rel="prefetch" href="/assets/js/11.799cf6c3.js"><link rel="prefetch" href="/assets/js/13.632cd73c.js"><link rel="prefetch" href="/assets/js/15.c36e301c.js"><link rel="prefetch" href="/assets/js/16.8cd163e8.js"><link rel="prefetch" href="/assets/js/17.a9f6ad9c.js"><link rel="prefetch" href="/assets/js/18.e71928be.js"><link rel="prefetch" href="/assets/js/19.c86cfc07.js"><link rel="prefetch" href="/assets/js/20.bb465aec.js"><link rel="prefetch" href="/assets/js/21.19999406.js"><link rel="prefetch" href="/assets/js/22.c9e27b35.js"><link rel="prefetch" href="/assets/js/23.524ed88b.js"><link rel="prefetch" href="/assets/js/24.c3ee01c0.js"><link rel="prefetch" href="/assets/js/25.0bb3c8cc.js">
    <link rel="stylesheet" href="/assets/css/0.styles.c6f2c4ad.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container api"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/hero.png" alt="Orango" class="logo"> <span class="site-name can-hide">Orango</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/guide/getting-started.html" class="nav-link">Guide</a></div><div class="nav-item"><a href="/api/" class="nav-link router-link-active">API</a></div> <a href="https://github.com/roboncode/orango" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/guide/getting-started.html" class="nav-link">Guide</a></div><div class="nav-item"><a href="/api/" class="nav-link router-link-active">API</a></div> <a href="https://github.com/roboncode/orango" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading"><span>Guide</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/guide/installation.html" class="sidebar-link">Installation</a></li><li><a href="/guide/getting-started.html" class="sidebar-link">Getting Started</a></li><li><a href="/guide/working-with-models.html" class="sidebar-link">Working with models</a></li><li><a href="/guide/best-practices.html" class="sidebar-link">Tips and Tricks</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading open"><span>API</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/api/orango.html" class="sidebar-link">orango</a></li><li><a href="/api/connection.html" class="sidebar-link">Connection</a></li><li><a href="/api/consts.html" class="sidebar-link">Constants</a></li><li><a href="/api/schema.html" class="active sidebar-link">Schema</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/api/schema.html#overview" class="sidebar-link">Overview</a></li><li class="sidebar-sub-header"><a href="/api/schema.html#schema-definitions" class="sidebar-link">Schema definitions</a></li><li class="sidebar-sub-header"><a href="/api/schema.html#schema-rules" class="sidebar-link">Schema rules</a></li><li class="sidebar-sub-header"><a href="/api/schema.html#using-joi" class="sidebar-link">Using Joi</a></li><li class="sidebar-sub-header"><a href="/api/schema.html#scoped-required-properties" class="sidebar-link">Scoped required properties</a></li><li class="sidebar-sub-header"><a href="/api/schema.html#strict-mode" class="sidebar-link">Strict mode</a></li><li class="sidebar-sub-header"><a href="/api/schema.html#indexing" class="sidebar-link">Indexing</a></li></ul></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="schema"><a href="#schema" aria-hidden="true" class="header-anchor">#</a> Schema</h1> <h2 id="overview"><a href="#overview" aria-hidden="true" class="header-anchor">#</a> Overview</h2> <p>Schemas define the structure, properties and rules for a model. They also define a collections indexed properties. Schemas are used to perform validation and filter out unknown properties ensuring the database only contains valid data you have defined.</p> <p><strong>Simple usage example</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token keyword">extends</span> <span class="token class-name">orango<span class="token punctuation">.</span>Model</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> User<span class="token punctuation">.</span>schema<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

User<span class="token punctuation">.</span>schema <span class="token operator">=</span> orango<span class="token punctuation">.</span><span class="token function">schema</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  firstName<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
  lastName<span class="token punctuation">:</span> String
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  indexes<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span> type<span class="token punctuation">:</span> <span class="token string">'hash'</span><span class="token punctuation">,</span> fields<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'firstName'</span><span class="token punctuation">,</span> <span class="token string">'lastName'</span><span class="token punctuation">]</span> <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>The schema is has two parts:</p> <ol><li>An object that defines valid properties, types and requirements</li> <li>An <em>optional</em> sencond object that defines indexes that should exist in the ArangoDB collection.</li></ol> <h2 id="schema-definitions"><a href="#schema-definitions" aria-hidden="true" class="header-anchor">#</a> Schema definitions</h2> <p>Schema definitions are built using <a href="https://github.com/roboncode/tang" target="_blank" rel="noopener noreferrer">Tang<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> and <a href="https://github.com/hapijs/joi" target="_blank" rel="noopener noreferrer">Joi<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> libraries. Tang allows you to build Joi descriptions using JSON.</p> <p>Joi is an object schema description language and validator for JavaScript objects. In addition to
validation, it provides a flexible way of creating schemas for a wide variety of scenarios and is
easily extensible.  To learn about all available validation properties, <a href="https://github.com/hapijs/joi" target="_blank" rel="noopener noreferrer">refer to the Joi
API documentation<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <p>Defining your schema can be done several different ways...</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// Type definition only</span>
orango<span class="token punctuation">.</span><span class="token function">schema</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  firstName<span class="token punctuation">:</span> String
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// Type definition in object</span>
orango<span class="token punctuation">.</span><span class="token function">schema</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  firstName<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    type<span class="token punctuation">:</span> String
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// Joi definition</span>
orango<span class="token punctuation">.</span><span class="token function">schema</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  firstName<span class="token punctuation">:</span> Joi<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="schema-rules"><a href="#schema-rules" aria-hidden="true" class="header-anchor">#</a> Schema rules</h2> <p>You can implement schemas with rules such as min, max, regex, etc. Once again look at Joi for options.</p> <div class="language-js extra-class"><pre class="language-js"><code>orango<span class="token punctuation">.</span><span class="token function">schema</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  firstName<span class="token punctuation">:</span> <span class="token punctuation">{</span> type<span class="token punctuation">:</span> String<span class="token punctuation">,</span> min<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> max<span class="token punctuation">:</span> <span class="token number">15</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  lastName<span class="token punctuation">:</span> <span class="token punctuation">{</span> type<span class="token punctuation">:</span> String<span class="token punctuation">,</span> min<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> max<span class="token punctuation">:</span> <span class="token number">15</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  email<span class="token punctuation">:</span> <span class="token punctuation">{</span> type<span class="token punctuation">:</span> String<span class="token punctuation">,</span> email<span class="token punctuation">:</span> <span class="token punctuation">{</span> minDomainAtoms<span class="token punctuation">:</span> <span class="token number">2</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="using-joi"><a href="#using-joi" aria-hidden="true" class="header-anchor">#</a> Using Joi</h2> <p>Even though it is recommended to use JSON when creating schemas, if you have complex rules, you can
alterntatively use Joi for some or all of the schema definition. Let's look at how you can use Joi
and how you can use a hybrid of JSON and Joi.</p> <blockquote><p>This example comes straight from Joi's <code>readme.md</code> in Github.</p></blockquote> <h3 id="joi-implementation"><a href="#joi-implementation" aria-hidden="true" class="header-anchor">#</a> Joi implementation</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> schema <span class="token operator">=</span> Joi<span class="token punctuation">.</span><span class="token function">object</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    username<span class="token punctuation">:</span> Joi<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">alphanum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">required</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    password<span class="token punctuation">:</span> Joi<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">regex</span><span class="token punctuation">(</span><span class="token regex">/^[a-zA-Z0-9]{3,30}$/</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    access_token<span class="token punctuation">:</span> <span class="token punctuation">[</span> Joi<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Joi<span class="token punctuation">.</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>
    birthyear<span class="token punctuation">:</span> Joi<span class="token punctuation">.</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">integer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span><span class="token number">1900</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token number">2013</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    email<span class="token punctuation">:</span> Joi<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">email</span><span class="token punctuation">(</span><span class="token punctuation">{</span> minDomainAtoms<span class="token punctuation">:</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token keyword">with</span><span class="token punctuation">(</span><span class="token string">'username'</span><span class="token punctuation">,</span> <span class="token string">'birthyear'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">without</span><span class="token punctuation">(</span><span class="token string">'password'</span><span class="token punctuation">,</span> <span class="token string">'access_token'</span><span class="token punctuation">)</span>

User<span class="token punctuation">.</span>schema <span class="token operator">=</span> orango<span class="token punctuation">.</span><span class="token function">schema</span><span class="token punctuation">(</span>schema<span class="token punctuation">)</span>
</code></pre></div><h3 id="json-sprinkled-with-joi"><a href="#json-sprinkled-with-joi" aria-hidden="true" class="header-anchor">#</a> JSON sprinkled with Joi</h3> <p>If you are not familiar with Joi, coming from Mongoose or just prefer to build using JSON,
you can create a similar schema with JSON.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> schema <span class="token operator">=</span> <span class="token punctuation">{</span>
  username<span class="token punctuation">:</span> <span class="token punctuation">{</span> type<span class="token punctuation">:</span> String<span class="token punctuation">,</span> alphanum<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> min<span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">,</span> max<span class="token punctuation">:</span> <span class="token number">30</span><span class="token punctuation">,</span> required<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  password<span class="token punctuation">:</span> <span class="token punctuation">{</span> type<span class="token punctuation">:</span> String<span class="token punctuation">,</span> regex<span class="token punctuation">:</span> <span class="token regex">/^[a-zA-Z0-9]{3,30}$/</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  access_token<span class="token punctuation">:</span> <span class="token punctuation">{</span> type<span class="token punctuation">:</span> <span class="token punctuation">[</span> String<span class="token punctuation">,</span> Number <span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  birthyear<span class="token punctuation">:</span> <span class="token punctuation">{</span> type<span class="token punctuation">:</span> Number<span class="token punctuation">,</span> integer<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> min<span class="token punctuation">:</span> <span class="token number">1900</span><span class="token punctuation">,</span> max<span class="token punctuation">:</span> <span class="token number">2018</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  email<span class="token punctuation">:</span> <span class="token punctuation">{</span> type<span class="token punctuation">:</span> String<span class="token punctuation">,</span> email<span class="token punctuation">:</span> <span class="token punctuation">{</span> minDomainAtoms<span class="token punctuation">:</span> <span class="token number">2</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> UserSchema <span class="token operator">=</span> orango<span class="token punctuation">.</span><span class="token function">schema</span><span class="token punctuation">(</span>schema<span class="token punctuation">)</span>
UserSchema<span class="token punctuation">.</span>joi <span class="token operator">=</span> UserSchema<span class="token punctuation">.</span>joi
  <span class="token punctuation">.</span><span class="token keyword">with</span><span class="token punctuation">(</span><span class="token string">'username'</span><span class="token punctuation">,</span> <span class="token string">'birthyear'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">without</span><span class="token punctuation">(</span><span class="token string">'password'</span><span class="token punctuation">,</span> <span class="token string">'access_token'</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="mixing-the-example-above-with-joi-and-json"><a href="#mixing-the-example-above-with-joi-and-json" aria-hidden="true" class="header-anchor">#</a> Mixing the example above with Joi and JSON.</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> schema <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// scoped required property only required on create</span>
  username<span class="token punctuation">:</span> <span class="token punctuation">{</span> type<span class="token punctuation">:</span> String<span class="token punctuation">,</span> alphanum<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> min<span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">,</span> max<span class="token punctuation">:</span> <span class="token number">30</span><span class="token punctuation">,</span> required<span class="token punctuation">:</span> <span class="token string">'insert'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// Joi inserted into Tang</span>
  password<span class="token punctuation">:</span> Joi<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">regex</span><span class="token punctuation">(</span><span class="token regex">/^[a-zA-Z0-9]{3,30}$/</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token comment">// scoped required property required on update</span>
  access_token<span class="token punctuation">:</span> <span class="token punctuation">{</span> type<span class="token punctuation">:</span> <span class="token punctuation">[</span> String<span class="token punctuation">,</span> Number <span class="token punctuation">]</span><span class="token punctuation">,</span> required<span class="token punctuation">:</span> <span class="token string">'update'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// birthyear is required on create because of with() below</span>
  birthyear<span class="token punctuation">:</span> <span class="token punctuation">{</span> type<span class="token punctuation">:</span> Number<span class="token punctuation">,</span> integer<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> min<span class="token punctuation">:</span> <span class="token number">1900</span><span class="token punctuation">,</span> max<span class="token punctuation">:</span> <span class="token number">2018</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// scoped required property required on create</span>
  email<span class="token punctuation">:</span> <span class="token punctuation">{</span> type<span class="token punctuation">:</span> String<span class="token punctuation">,</span> email<span class="token punctuation">:</span> <span class="token punctuation">{</span> minDomainAtoms<span class="token punctuation">:</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> required<span class="token punctuation">:</span> <span class="token string">'create'</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> UserSchema <span class="token operator">=</span> orango<span class="token punctuation">.</span><span class="token function">schema</span><span class="token punctuation">(</span>schema<span class="token punctuation">)</span>
UserSchema<span class="token punctuation">.</span>joi <span class="token operator">=</span> UserSchema<span class="token punctuation">.</span>joi
  <span class="token punctuation">.</span><span class="token keyword">with</span><span class="token punctuation">(</span><span class="token string">'username'</span><span class="token punctuation">,</span> <span class="token string">'birthyear'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">without</span><span class="token punctuation">(</span><span class="token string">'password'</span><span class="token punctuation">,</span> <span class="token string">'access_token'</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="scoped-required-properties"><a href="#scoped-required-properties" aria-hidden="true" class="header-anchor">#</a> Scoped required properties</h2> <p>The JSON notation has some advantages Joi does not provide. You can create <code>scoped required properties</code>.
Let's look at some examples with explanations.</p> <div class="language-js extra-class"><pre class="language-js"><code>User<span class="token punctuation">.</span>schema <span class="token operator">=</span> orango<span class="token punctuation">.</span><span class="token function">schema</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  email<span class="token punctuation">:</span> <span class="token punctuation">{</span> type<span class="token punctuation">:</span> String<span class="token punctuation">,</span> required<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span> <span class="token comment">// required on inserts and updates</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

User<span class="token punctuation">.</span>schema <span class="token operator">=</span> orango<span class="token punctuation">.</span><span class="token function">schema</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  email<span class="token punctuation">:</span> <span class="token punctuation">{</span> type<span class="token punctuation">:</span> String<span class="token punctuation">,</span> required<span class="token punctuation">:</span> <span class="token string">'insert'</span> <span class="token punctuation">}</span> <span class="token comment">// required only on inserts</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

User<span class="token punctuation">.</span>schema <span class="token operator">=</span> orango<span class="token punctuation">.</span><span class="token function">schema</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  email<span class="token punctuation">:</span> <span class="token punctuation">{</span> type<span class="token punctuation">:</span> String<span class="token punctuation">,</span> required<span class="token punctuation">:</span> <span class="token string">'update'</span> <span class="token punctuation">}</span> <span class="token comment">// required only on updates</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="strict-mode"><a href="#strict-mode" aria-hidden="true" class="header-anchor">#</a> Strict mode</h2> <p>By default, Orango enables a strict mode which filters out undefined properties. If you wish to have the schema allow for unknown properties, set <code>strict</code> to <code>false</code>.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> <span class="token constant">SCHEMA</span> <span class="token punctuation">}</span> <span class="token operator">=</span> orango<span class="token punctuation">.</span>consts

User<span class="token punctuation">.</span>schema <span class="token operator">=</span> orango<span class="token punctuation">.</span><span class="token function">schema</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  firstName<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
  lastName<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
  email<span class="token punctuation">:</span> String
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  strict<span class="token punctuation">:</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="indexing"><a href="#indexing" aria-hidden="true" class="header-anchor">#</a> Indexing</h2> <p>You can define indexes for your collections in the second parameter of the schema function.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> <span class="token constant">SCHEMA</span> <span class="token punctuation">}</span> <span class="token operator">=</span> orango<span class="token punctuation">.</span>consts

User<span class="token punctuation">.</span>schema <span class="token operator">=</span> orango<span class="token punctuation">.</span><span class="token function">schema</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  firstName<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
  lastName<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
  email<span class="token punctuation">:</span> String
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  indexes<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      type<span class="token punctuation">:</span> <span class="token constant">SCHEMA</span><span class="token punctuation">.</span><span class="token constant">INDEX</span><span class="token punctuation">.</span><span class="token constant">HASH</span><span class="token punctuation">,</span>
      fields<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'email'</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>Index is an array in the options object. The following indexes are supported. ArangoDB documentation can be found here regarding each indexing type: <a href="https://docs.arangodb.com/devel/Drivers/JS/Reference/Collection/Indexes.html" target="_blank" rel="noopener noreferrer">https://docs.arangodb.com/devel/Drivers/JS/Reference/Collection/Indexes.html<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h4 id="hash"><a href="#hash" aria-hidden="true" class="header-anchor">#</a> Hash</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span>
  type<span class="token punctuation">:</span> <span class="token constant">SCHEMA</span><span class="token punctuation">.</span><span class="token constant">INDEX</span><span class="token punctuation">.</span><span class="token constant">HASH</span><span class="token punctuation">,</span>
  fields<span class="token punctuation">:</span> <span class="token punctuation">[</span>String<span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="skip-list"><a href="#skip-list" aria-hidden="true" class="header-anchor">#</a> Skip list</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span>
  type<span class="token punctuation">:</span> <span class="token constant">SCHEMA</span><span class="token punctuation">.</span><span class="token constant">INDEX</span><span class="token punctuation">.</span><span class="token constant">SKIP_LIST</span><span class="token punctuation">,</span>
  fields<span class="token punctuation">:</span> <span class="token punctuation">[</span>String<span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="geo"><a href="#geo" aria-hidden="true" class="header-anchor">#</a> Geo</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span>
  type<span class="token punctuation">:</span> <span class="token constant">SCHEMA</span><span class="token punctuation">.</span><span class="token constant">INDEX</span><span class="token punctuation">.</span><span class="token constant">HASH</span><span class="token punctuation">,</span>
  fields<span class="token punctuation">:</span> <span class="token punctuation">[</span>String<span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="fulltext"><a href="#fulltext" aria-hidden="true" class="header-anchor">#</a> Fulltext</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span>
  type<span class="token punctuation">:</span> <span class="token constant">SCHEMA</span><span class="token punctuation">.</span><span class="token constant">INDEX</span><span class="token punctuation">.</span><span class="token constant">HASH</span><span class="token punctuation">,</span>
  fields<span class="token punctuation">:</span> <span class="token punctuation">[</span>String<span class="token punctuation">]</span><span class="token punctuation">,</span>
  minLength<span class="token punctuation">:</span> Number
<span class="token punctuation">}</span>
</code></pre></div><h4 id="persistent"><a href="#persistent" aria-hidden="true" class="header-anchor">#</a> Persistent</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span>
  type<span class="token punctuation">:</span> <span class="token constant">SCHEMA</span><span class="token punctuation">.</span><span class="token constant">INDEX</span><span class="token punctuation">.</span><span class="token constant">HASH</span><span class="token punctuation">,</span>
  fields<span class="token punctuation">:</span> <span class="token punctuation">[</span>String<span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/roboncode/orango/edit/master/docs/api/schema.md" target="_blank" rel="noopener noreferrer">Help us improve this page!</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">1/4/2019, 10:35:38 PM</span></div></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/api/consts.html" class="prev">
          Constants
        </a></span> <!----></p></div> </div> <!----></div></div>
    <script src="/assets/js/14.64c86a24.js" defer></script><script src="/assets/js/app.638713ad.js" defer></script>
  </body>
</html>
